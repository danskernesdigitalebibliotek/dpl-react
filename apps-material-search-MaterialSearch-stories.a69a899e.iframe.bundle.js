(globalThis.webpackChunk_danskernesdigitalebibliotek_dpl_react=globalThis.webpackChunk_danskernesdigitalebibliotek_dpl_react||[]).push([[4514],{"./src/apps/material-search/MaterialSearch.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Primary:()=>Primary,WithPreviouslySelectedValues:()=>WithPreviouslySelectedValues,default:()=>MaterialSearch_stories,materialWithInvalidType:()=>materialWithInvalidType,materialWithInvalidWorkId:()=>materialWithInvalidWorkId});var react=__webpack_require__("./node_modules/react/index.js"),globalTextArgs=__webpack_require__("./src/core/storybook/globalTextArgs.ts"),serviceUrlArgs=__webpack_require__("./src/core/storybook/serviceUrlArgs.ts"),globalConfigArgs=__webpack_require__("./src/core/storybook/globalConfigArgs.ts"),config=__webpack_require__("./src/core/utils/config.tsx"),utils_text=__webpack_require__("./src/core/utils/text.tsx"),utils_url=__webpack_require__("./src/core/utils/url.tsx"),icon_warning=__webpack_require__("./node_modules/@danskernesdigitalebibliotek/dpl-design-system/build/icons/basic/icon-warning.svg"),icon_warning_default=__webpack_require__.n(icon_warning);const MaterialSearchBaseError=({headingText,children})=>react.createElement("div",{className:"material-search__error"},react.createElement("div",{className:"material-search__error-header"},react.createElement("img",{src:icon_warning_default(),className:"material-search__error-icon",alt:""}),react.createElement("h3",{className:"material-search__error-header-text"},headingText)),children),Errors_MaterialSearchBaseError=MaterialSearchBaseError;try{MaterialSearchBaseError.displayName="MaterialSearchBaseError",MaterialSearchBaseError.__docgenInfo={description:"",displayName:"MaterialSearchBaseError",props:{headingText:{defaultValue:null,description:"",name:"headingText",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/material-search/Errors/MaterialSearchBaseError.tsx#MaterialSearchBaseError"]={docgenInfo:MaterialSearchBaseError.__docgenInfo,name:"MaterialSearchBaseError",path:"src/apps/material-search/Errors/MaterialSearchBaseError.tsx#MaterialSearchBaseError"})}catch(__react_docgen_typescript_loader_error){}const HiddenInputsNotFoundError=()=>{const t=(0,utils_text.F)();return react.createElement(Errors_MaterialSearchBaseError,{headingText:t("materialSearchErrorHiddenInputsNotFoundHeadingText")},react.createElement("div",{className:"material-search__error-content"},react.createElement("p",{className:"material-search__error-description"},t("materialSearchErrorHiddenInputsNotFoundDescriptionText"))))},Errors_HiddenInputsNotFoundError=HiddenInputsNotFoundError;try{HiddenInputsNotFoundError.displayName="HiddenInputsNotFoundError",HiddenInputsNotFoundError.__docgenInfo={description:"",displayName:"HiddenInputsNotFoundError",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/material-search/Errors/HiddenInputsNotFoundError.tsx#HiddenInputsNotFoundError"]={docgenInfo:HiddenInputsNotFoundError.__docgenInfo,name:"HiddenInputsNotFoundError",path:"src/apps/material-search/Errors/HiddenInputsNotFoundError.tsx#HiddenInputsNotFoundError"})}catch(__react_docgen_typescript_loader_error){}var ErrorState=function(ErrorState){return ErrorState.NoError="NoError",ErrorState.WorkError="WorkError",ErrorState.MaterialTypeError="MaterialTypeError",ErrorState.hiddenInputsNotFoundError="hiddenInputsNotFoundError",ErrorState}(ErrorState||{});const Errors_errorState=ErrorState,MaterialSearchInputs=({searchInput,setSearchInput,availableMaterialTypes,selectedMaterialType,handleUpdateMaterialType,work,uniqueIdentifier})=>{const t=(0,utils_text.F)();return react.createElement("div",{className:"material-search__inputs-container"},react.createElement("label",{className:"material-search__label",htmlFor:"material-search-input"},t("materialSearchSearchInputText"),react.createElement("input",{id:`material-search-input-${uniqueIdentifier}`,type:"search",value:searchInput,onChange:e=>setSearchInput(e.target.value),placeholder:t("materialSearchSearchInputPlaceholderText"),className:"material-search__input"})),react.createElement("label",{className:"material-search__label",htmlFor:"material-type-selector"},t("materialSearchMaterialTypeSelectorText"),react.createElement("select",{id:`material-type-selector-${uniqueIdentifier}`,className:"material-search__selector",disabled:!work||!availableMaterialTypes||0===availableMaterialTypes.length,onChange:e=>handleUpdateMaterialType(e.target.value),value:selectedMaterialType||""},react.createElement("option",{value:"",disabled:!0},t("materialSearchMaterialTypeSelectorNoneOptionText")),availableMaterialTypes&&availableMaterialTypes.map((type=>react.createElement("option",{key:type,value:type},type))))))},material_search_MaterialSearchInputs=MaterialSearchInputs;try{MaterialSearchInputs.displayName="MaterialSearchInputs",MaterialSearchInputs.__docgenInfo={description:"",displayName:"MaterialSearchInputs",props:{searchInput:{defaultValue:null,description:"",name:"searchInput",required:!0,type:{name:"string"}},setSearchInput:{defaultValue:null,description:"",name:"setSearchInput",required:!0,type:{name:"(value: string) => void"}},availableMaterialTypes:{defaultValue:null,description:"",name:"availableMaterialTypes",required:!0,type:{name:"ManifestationMaterialType[] | null"}},selectedMaterialType:{defaultValue:null,description:"",name:"selectedMaterialType",required:!0,type:{name:"ManifestationMaterialType | null"}},handleUpdateMaterialType:{defaultValue:null,description:"",name:"handleUpdateMaterialType",required:!0,type:{name:"(newValue: ManifestationMaterialType) => void"}},work:{defaultValue:null,description:"",name:"work",required:!0,type:{name:"Work | null"}},uniqueIdentifier:{defaultValue:null,description:"",name:"uniqueIdentifier",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/material-search/MaterialSearchInputs.tsx#MaterialSearchInputs"]={docgenInfo:MaterialSearchInputs.__docgenInfo,name:"MaterialSearchInputs",path:"src/apps/material-search/MaterialSearchInputs.tsx#MaterialSearchInputs"})}catch(__react_docgen_typescript_loader_error){}var cover=__webpack_require__("./src/components/cover/cover.tsx"),reload_logo_black=__webpack_require__("./node_modules/@danskernesdigitalebibliotek/dpl-design-system/build/icons/logo/reload_logo_black.svg"),reload_logo_black_default=__webpack_require__.n(reload_logo_black);const MaterialSearchLoading=({loadingText})=>react.createElement("div",{className:"material-search__loading"},react.createElement("img",{src:reload_logo_black_default(),alt:"",className:"material-search__loading-spinner"}),react.createElement("span",{className:"material-search__loading-text"},loadingText)),material_search_MaterialSearchLoading=MaterialSearchLoading;try{MaterialSearchLoading.displayName="MaterialSearchLoading",MaterialSearchLoading.__docgenInfo={description:"",displayName:"MaterialSearchLoading",props:{loadingText:{defaultValue:null,description:"",name:"loadingText",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/material-search/MaterialSearchLoading.tsx#MaterialSearchLoading"]={docgenInfo:MaterialSearchLoading.__docgenInfo,name:"MaterialSearchLoading",path:"src/apps/material-search/MaterialSearchLoading.tsx#MaterialSearchLoading"})}catch(__react_docgen_typescript_loader_error){}var general=__webpack_require__("./src/core/utils/helpers/general.ts"),useIntersection=__webpack_require__("./node_modules/react-use/esm/useIntersection.js"),util=__webpack_require__("./node_modules/react-use/esm/misc/util.js"),defaultTarget=util.Bd?window:null,isListenerType1=function(target){return!!target.addEventListener},isListenerType2=function(target){return!!target.on};const esm_useEvent=function(name,handler,target,options){void 0===target&&(target=defaultTarget),(0,react.useEffect)((function(){if(handler&&target)return isListenerType1(target)?(0,util.on)(target,name,handler,options):isListenerType2(target)&&target.on(name,handler,options),function(){isListenerType1(target)?(0,util.AU)(target,name,handler,options):isListenerType2(target)&&target.off(name,handler,options)}}),[name,handler,target,JSON.stringify(options)])};const esm_useKey=function(key,fn,opts,deps){void 0===fn&&(fn=util.lQ),void 0===opts&&(opts={}),void 0===deps&&(deps=[key]);var _a=opts.event,event=void 0===_a?"keydown":_a,target=opts.target,options=opts.options,useMemoHandler=(0,react.useMemo)((function(){var keyFilter,predicate="function"==typeof(keyFilter=key)?keyFilter:"string"==typeof keyFilter?function(event){return event.key===keyFilter}:keyFilter?function(){return!0}:function(){return!1};return function(handlerEvent){if(predicate(handlerEvent))return fn(handlerEvent)}}),deps);esm_useEvent(event,useMemoHandler,target,options)};const esm_useKeyPress=function(keyFilter){var _a=(0,react.useState)([!1,null]),state=_a[0],set=_a[1];return esm_useKey(keyFilter,(function(event){return set([!0,event])}),{event:"keydown"},[state]),esm_useKey(keyFilter,(function(event){return set([!1,event])}),{event:"keyup"},[state]),state};const esm_useUpdateEffect=function(effect,deps){var isFirstMount=function useFirstMountState(){var isFirst=(0,react.useRef)(!0);return isFirst.current?(isFirst.current=!1,!0):isFirst.current}();(0,react.useEffect)((function(){if(!isFirstMount)return effect()}),deps)};const esm_useKeyPressEvent=function(key,keydown,keyup,useKeyPress){void 0===useKeyPress&&(useKeyPress=esm_useKeyPress);var _a=useKeyPress(key),pressed=_a[0],event=_a[1];esm_useUpdateEffect((function(){!pressed&&keyup?keyup(event):pressed&&keydown&&keydown(event)}),[pressed])},useInfiteScrollLoading=({data,loadMore,hitCount,onWorkIdSelect})=>{const containerRef=(0,react.useRef)(null),lastItemRef=(0,react.useRef)(null),lastItemFocusRef=(0,react.useRef)(null),handleScroll=(0,react.useCallback)((()=>{if(containerRef.current){const{scrollTop,scrollHeight,clientHeight}=containerRef.current;scrollTop+clientHeight>=scrollHeight-5&&data.length<hitCount&&loadMore()}}),[loadMore,data.length,hitCount]);(0,react.useEffect)((()=>{const currentContainer=containerRef.current;return currentContainer&&currentContainer.addEventListener("scroll",handleScroll),()=>{currentContainer&&currentContainer.removeEventListener("scroll",handleScroll)}}),[handleScroll]);const intersection=(0,useIntersection.A)(lastItemRef,{root:containerRef.current,rootMargin:"0px",threshold:1});(0,react.useEffect)((()=>{intersection&&1===intersection.intersectionRatio&&data.length<hitCount&&loadMore()}),[intersection,loadMore,data.length,hitCount]);const handleKeySelect=(0,react.useCallback)((e=>{lastItemFocusRef.current&&(e.preventDefault(),onWorkIdSelect(lastItemFocusRef.current.dataset.workId))}),[onWorkIdSelect]);esm_useKeyPressEvent("Enter",handleKeySelect),esm_useKeyPressEvent(" ",handleKeySelect),esm_useKeyPressEvent("Tab",(()=>{lastItemFocusRef.current&&loadMore()}));const handleFocus=(0,react.useCallback)(((index,itemRef)=>{index===data.length-1?lastItemFocusRef.current=itemRef:lastItemFocusRef.current=null}),[data.length]);return(0,react.useEffect)((()=>{lastItemFocusRef.current&&lastItemFocusRef.current.focus()}),[data]),{containerRef,lastItemRef,handleFocus}},material_search_MaterialSearchList=({data,isLoading,onWorkIdSelect,selectedWorkId,loadMore,hitCount})=>{const t=(0,utils_text.F)(),{containerRef,lastItemRef,handleFocus}=useInfiteScrollLoading({data,isLoading,loadMore,hitCount,onWorkIdSelect});if(isLoading&&0===data.length)return react.createElement("div",{className:"material-search-list"},react.createElement("div",{className:"material-search-list__header"}),react.createElement("ul",{className:"material-search-list__results"},react.createElement("li",{className:"material-search-list__loading"},react.createElement(material_search_MaterialSearchLoading,{loadingText:t("materialSearchLoadingText")}))));if(!data||0===data.length)return null;const works=data;return react.createElement("div",{className:"material-search-list",ref:containerRef},react.createElement("div",{className:"material-search-list__header"},t("materialSearchAmountOfResultsText"),":",react.createElement("span",null,hitCount)),react.createElement("ol",{className:"material-search-list__results"},works.map(((work,index)=>{const authors=(0,general.UV)(work.creators),isLastItem=index===data.length-1;return react.createElement("li",{className:"material-search-list__item "+(selectedWorkId===work.workId?"material-search-list__item--highlighted":""),key:work.workId,ref:isLastItem?lastItemRef:null},react.createElement("button",{className:"material-search-list__button",type:"button",tabIndex:0,onClick:e=>{e.preventDefault(),onWorkIdSelect(work.workId)},onFocus:e=>handleFocus(index,e.currentTarget),"aria-label":t("materialSearchAriaButtonSelectWorkWithText",{placeholders:{"@title":`${work.titles.full}`}})},react.createElement(cover.Y,{size:"large",displaySize:"2xsmall",ids:[work.manifestations.bestRepresentation.pid],animate:!0}),react.createElement("div",null,react.createElement("div",{className:"material-search-list__detail-item"},react.createElement("span",{className:"material-search-list__term"},t("materialSearchPreviewTitleText"),":"),react.createElement("span",{className:"material-search-list__detail"},work.titles.full)),react.createElement("div",{className:"material-search-list__detail-item"},react.createElement("span",{className:"material-search-list__term"},t("materialSearchPreviewAuthorText"),":"),react.createElement("span",{className:"material-search-list__detail"},authors)))))})),isLoading&&react.createElement("li",{className:"material-search-list__loading"},react.createElement(material_search_MaterialSearchLoading,{loadingText:t("materialSearchLoadingText")}))))};try{MaterialSearchList.displayName="MaterialSearchList",MaterialSearchList.__docgenInfo={description:"",displayName:"MaterialSearchList",props:{data:{defaultValue:null,description:"",name:"data",required:!0,type:{name:'{ __typename?: "Work" | undefined; workId: string; abstract?: string[] | null | undefined; genreAndForm: string[]; titles: { __typename?: "WorkTitles" | undefined; full: string[]; original?: string[] | null | undefined; }; creators: ({ ...; } | { ...; })[]; series: { ...; }[]; workYear?: { ...; } | ... 1 more ... | ...'}},isLoading:{defaultValue:null,description:"",name:"isLoading",required:!0,type:{name:"boolean"}},onWorkIdSelect:{defaultValue:null,description:"",name:"onWorkIdSelect",required:!0,type:{name:"(workId: `work-of:${number}-${string}:${string}`) => void"}},selectedWorkId:{defaultValue:null,description:"",name:"selectedWorkId",required:!1,type:{name:"string | undefined"}},loadMore:{defaultValue:null,description:"",name:"loadMore",required:!0,type:{name:"() => void"}},hitCount:{defaultValue:null,description:"",name:"hitCount",required:!0,type:{name:"number"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/material-search/MaterialSearchList.tsx#MaterialSearchList"]={docgenInfo:MaterialSearchList.__docgenInfo,name:"MaterialSearchList",path:"src/apps/material-search/MaterialSearchList.tsx#MaterialSearchList"})}catch(__react_docgen_typescript_loader_error){}var helper=__webpack_require__("./src/apps/material/helper.ts"),helpers_url=__webpack_require__("./src/core/utils/helpers/url.ts");const MaterialTypeNotFoundError=({work:{titles:{full:fullTitle},creators,workId:wid}})=>{const u=(0,utils_url.Ik)(),t=(0,utils_text.F)(),materialUrl=u("materialUrl"),url=(0,helpers_url.Qj)(materialUrl,wid),authors=(0,general.sP)((0,general.UV)(creators),t);return react.createElement(Errors_MaterialSearchBaseError,{headingText:t("materialSearchErrorHeaderText")},react.createElement("div",{className:"material-search__error-content"},react.createElement("p",{className:"material-search__error-description"},t("materialSearchErrorMaterialTypeNotFoundText")),react.createElement("div",{className:"material-search__error-material-content"},react.createElement("div",{className:"material-search__error-item"},react.createElement("span",{className:"material-search__error-term"},t("materialSearchErrorTitleText"),":"),react.createElement("span",{className:"material-search__error-detail"},fullTitle)),react.createElement("div",{className:"material-search__error-item"},react.createElement("span",{className:"material-search__error-term"},t("materialSearchErrorAuthorText"),":"),react.createElement("span",{className:"material-search__error-detail"},authors)),react.createElement("div",{className:"material-search__error-item"},react.createElement("span",{className:"material-search__error-term"},t("materialSearchErrorLinkText"),":"),react.createElement("a",{href:url.href,target:"_blank",className:"material-search__error-link",rel:"noreferrer noopener"},url.href)))))},Errors_MaterialTypeNotFoundError=MaterialTypeNotFoundError;try{MaterialTypeNotFoundError.displayName="MaterialTypeNotFoundError",MaterialTypeNotFoundError.__docgenInfo={description:"",displayName:"MaterialTypeNotFoundError",props:{work:{defaultValue:null,description:"",name:"work",required:!0,type:{name:"Work"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/material-search/Errors/MaterialTypeNotFoundError.tsx#MaterialTypeNotFoundError"]={docgenInfo:MaterialTypeNotFoundError.__docgenInfo,name:"MaterialTypeNotFoundError",path:"src/apps/material-search/Errors/MaterialTypeNotFoundError.tsx#MaterialTypeNotFoundError"})}catch(__react_docgen_typescript_loader_error){}const WorkNotFoundError=()=>{const t=(0,utils_text.F)();return react.createElement(Errors_MaterialSearchBaseError,{headingText:t("materialSearchErrorHeaderText")},react.createElement("div",{className:"material-search__error-content"},react.createElement("p",{className:"material-search__error-description"},t("materialSearchErrorWorkNotFoundText"))))},Errors_WorkNotFoundError=WorkNotFoundError;try{WorkNotFoundError.displayName="WorkNotFoundError",WorkNotFoundError.__docgenInfo={description:"",displayName:"WorkNotFoundError",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/material-search/Errors/WorkNotFoundError.tsx#WorkNotFoundError"]={docgenInfo:WorkNotFoundError.__docgenInfo,name:"WorkNotFoundError",path:"src/apps/material-search/Errors/WorkNotFoundError.tsx#WorkNotFoundError"})}catch(__react_docgen_typescript_loader_error){}const MaterialSearchPreview=({work,selectedMaterialType,isLoading,errorState})=>{var _materialForDisplay$e,_materialForDisplay$e2;const t=(0,utils_text.F)(),[materialForDisplay,setMaterialForDisplay]=(0,react.useState)(null);if((0,react.useEffect)((()=>{if(!work)return;if(!selectedMaterialType)return void setMaterialForDisplay(work.manifestations.bestRepresentation);const manifestation=(0,helper.xb)(work,selectedMaterialType);setMaterialForDisplay(manifestation)}),[work,selectedMaterialType]),isLoading)return react.createElement("div",{className:"material-search__preview"},react.createElement("div",{className:"material-search__preview-loading"},react.createElement(material_search_MaterialSearchLoading,{loadingText:t("materialSearchLoadingText")})));if(errorState===Errors_errorState.WorkError)return react.createElement(Errors_WorkNotFoundError,null);if(work&&errorState===Errors_errorState.MaterialTypeError)return react.createElement(Errors_MaterialTypeNotFoundError,{work});if(!work||!materialForDisplay)return react.createElement("div",{className:"material-search__preview"},react.createElement("div",{className:"material-search__preview-empty"},t("materialSearchNoMaterialSelectedText")));const author=(0,general.sP)((0,general.UV)(work.creators),t);return react.createElement("div",{className:"material-search__preview"},react.createElement("div",{className:"material-search__preview-material"},react.createElement(cover.Y,{ids:[materialForDisplay.pid],size:"large",displaySize:"small",animate:!0,alt:`Cover for ${materialForDisplay.titles.main}`,shadow:"small"}),react.createElement("div",null,react.createElement("div",{className:"material-search__preview-item"},react.createElement("span",{className:"material-search__preview-term"},t("materialSearchPreviewTitleText"),":"),react.createElement("span",{className:"material-search__preview-detail"},materialForDisplay.titles.main)),react.createElement("div",{className:"material-search__preview-item"},react.createElement("span",{className:"material-search__preview-term"},t("materialSearchPreviewAuthorText"),":"),react.createElement("span",{className:"material-search__preview-detail"},author)),react.createElement("div",{className:"material-search__preview-item"},react.createElement("span",{className:"material-search__preview-term"},t("materialSearchPreviewPublicationYearText"),":"),react.createElement("span",{className:"material-search__preview-detail"},null===(_materialForDisplay$e=materialForDisplay.edition)||void 0===_materialForDisplay$e||null===(_materialForDisplay$e2=_materialForDisplay$e.publicationYear)||void 0===_materialForDisplay$e2?void 0:_materialForDisplay$e2.display)),react.createElement("div",{className:"material-search__preview-item"},react.createElement("span",{className:"material-search__preview-term"},t("materialSearchPreviewSourceText"),":"),react.createElement("span",{className:"material-search__preview-detail"},materialForDisplay.source)),react.createElement("div",{className:"material-search__preview-item"},react.createElement("span",{className:"material-search__preview-term"},t("materialSearchPreviewWorkIdText"),":"),react.createElement("span",{className:"material-search__preview-detail"},work.workId)))))},material_search_MaterialSearchPreview=MaterialSearchPreview;try{MaterialSearchPreview.displayName="MaterialSearchPreview",MaterialSearchPreview.__docgenInfo={description:"",displayName:"MaterialSearchPreview",props:{work:{defaultValue:null,description:"",name:"work",required:!0,type:{name:"Work | null"}},selectedMaterialType:{defaultValue:null,description:"",name:"selectedMaterialType",required:!0,type:{name:"ManifestationMaterialType | null"}},isLoading:{defaultValue:null,description:"",name:"isLoading",required:!0,type:{name:"boolean"}},errorState:{defaultValue:null,description:"",name:"errorState",required:!0,type:{name:"enum",value:[{value:'"NoError"'},{value:'"WorkError"'},{value:'"MaterialTypeError"'},{value:'"hiddenInputsNotFoundError"'}]}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/material-search/MaterialSearchPreview.tsx#MaterialSearchPreview"]={docgenInfo:MaterialSearchPreview.__docgenInfo,name:"MaterialSearchPreview",path:"src/apps/material-search/MaterialSearchPreview.tsx#MaterialSearchPreview"})}catch(__react_docgen_typescript_loader_error){}var graphql=__webpack_require__("./src/core/dbc-gateway/generated/graphql.tsx");const material_search_useGetMaterialListSearch=()=>{const[state,setState]=(0,react.useState)({searchInput:"",page:1}),[searchListData,setSearchListData]=(0,react.useState)([]),[hitCount,setHitCount]=(0,react.useState)(0),{searchInput,page}=state,queryVariables={q:{all:searchInput},offset:10*(page-1),limit:10},{data,isLoading}=(0,graphql.KG)(queryVariables);(0,react.useEffect)((()=>{var _data$search;null!=data&&null!==(_data$search=data.search)&&void 0!==_data$search&&_data$search.works&&(setSearchListData((prevData=>1===page?data.search.works:[...prevData,...data.search.works])),setHitCount(data.search.hitcount))}),[data,page]);return{searchListData,isLoading,searchInput,setSearchInput:(0,react.useCallback)((input=>{setState({searchInput:input,page:1})}),[]),loadMore:(0,react.useCallback)((()=>{setState((prevState=>({...prevState,page:prevState.page+1})))}),[]),hitCount}},material_search_useGetSelectedWork=()=>{const[selectedWorkId,setSelectedWorkId]=(0,react.useState)(""),[selectedMaterialType,setSelectedMaterialType]=(0,react.useState)(null),[errorState,setErrorState]=(0,react.useState)(Errors_errorState.NoError),{data,isLoading:isSelectedWorkLoading,refetch}=(0,graphql.RR)({wid:selectedWorkId},{enabled:!!selectedWorkId&&selectedWorkId.length>0,onSuccess:responseData=>{if(responseData.work){if(selectedMaterialType&&responseData.work){const work=responseData.work,availableMaterialTypes=work?(0,general.JB)(work.manifestations.all,!1):null;if(availableMaterialTypes&&!availableMaterialTypes.includes(selectedMaterialType))return void setErrorState(Errors_errorState.MaterialTypeError)}setErrorState(Errors_errorState.NoError)}else setErrorState(Errors_errorState.WorkError)}});(0,react.useEffect)((()=>{selectedWorkId&&refetch()}),[selectedWorkId,selectedMaterialType,refetch]);const work=(null==data?void 0:data.work)??null;return{work,availableMaterialTypes:work?(0,general.JB)(work.manifestations.all,!1):null,selectedWorkId,setSelectedMaterialType,isSelectedWorkLoading,setSelectedWorkId,selectedMaterialType,errorState}},useGetHiddenInputs=uniqueIdentifier=>{const[workIdElement,setWorkIdElement]=(0,react.useState)(null),[materialTypeElement,setMaterialTypeElement]=(0,react.useState)(null),[errorState,setErrorState]=(0,react.useState)(Errors_errorState.NoError);return(0,react.useEffect)((()=>{const workElement=document.querySelector(`[data-field-input-work-id="${uniqueIdentifier}"]`),materialElement=document.querySelector(`[data-field-input-material-type-id="${uniqueIdentifier}"]`);workElement?setWorkIdElement(workElement):(console.debug(`Could not find input for work ID with unique identifier: ${uniqueIdentifier}`),setErrorState(Errors_errorState.hiddenInputsNotFoundError)),materialElement?setMaterialTypeElement(materialElement):(console.debug(`Could not find input for material type with unique identifier: ${uniqueIdentifier}`),setErrorState(Errors_errorState.hiddenInputsNotFoundError)),workElement&&materialElement&&setErrorState(Errors_errorState.NoError)}),[uniqueIdentifier]),{workIdElement,materialTypeElement,errorState}},material_search_useGetHiddenInputs=useGetHiddenInputs;try{useGetHiddenInputs.displayName="useGetHiddenInputs",useGetHiddenInputs.__docgenInfo={description:"",displayName:"useGetHiddenInputs",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/material-search/useGetHiddenInputs.tsx#useGetHiddenInputs"]={docgenInfo:useGetHiddenInputs.__docgenInfo,name:"useGetHiddenInputs",path:"src/apps/material-search/useGetHiddenInputs.tsx#useGetHiddenInputs"})}catch(__react_docgen_typescript_loader_error){}const material_search_useUpdateFields=({updateSelectedWorkId,updateSelectedMaterialType,uniqueIdentifier})=>{const workIdRef=(0,react.useRef)(null),materialTypeRef=(0,react.useRef)(null);(0,react.useEffect)((()=>{workIdRef.current=document.querySelector(`[data-field-input-work-id="${uniqueIdentifier}"]`),materialTypeRef.current=document.querySelector(`[data-field-input-material-type-id="${uniqueIdentifier}"]`)}),[uniqueIdentifier]);const updateInputValue=(0,react.useCallback)(((inputElement,newValue)=>{if(inputElement){return inputElement.value=newValue,!0}return console.debug(`Could not find input element to update with ID: ${uniqueIdentifier}`),!1}),[uniqueIdentifier]);return{handleUpdateWorkId:(0,react.useCallback)((wid=>{const workIdUpdateSuccess=updateInputValue(workIdRef.current,`${wid}`),materialTypeUpdateSuccess=updateInputValue(materialTypeRef.current,"");workIdUpdateSuccess&&materialTypeUpdateSuccess&&(updateSelectedWorkId(wid),updateSelectedMaterialType(null))}),[updateInputValue,updateSelectedWorkId,updateSelectedMaterialType]),handleUpdateMaterialType:(0,react.useCallback)((newValue=>{updateInputValue(materialTypeRef.current,newValue)&&updateSelectedMaterialType(newValue)}),[updateInputValue,updateSelectedMaterialType])}},MaterialSearch=({uniqueIdentifier})=>{const{availableMaterialTypes,work,isSelectedWorkLoading,selectedWorkId,setSelectedWorkId,selectedMaterialType,setSelectedMaterialType,errorState}=material_search_useGetSelectedWork(),{searchInput,setSearchInput,searchListData,isLoading:isSearchResultsLoading,hitCount,loadMore}=material_search_useGetMaterialListSearch(),{handleUpdateWorkId,handleUpdateMaterialType}=material_search_useUpdateFields({updateSelectedWorkId:setSelectedWorkId,updateSelectedMaterialType:setSelectedMaterialType,uniqueIdentifier}),{workIdElement,materialTypeElement,errorState:hiddenInputErrorState}=material_search_useGetHiddenInputs(uniqueIdentifier);return(0,react.useEffect)((()=>{workIdElement&&workIdElement.value&&setSelectedWorkId(null==workIdElement?void 0:workIdElement.value),materialTypeElement&&materialTypeElement.value&&setSelectedMaterialType(null==materialTypeElement?void 0:materialTypeElement.value)}),[workIdElement,materialTypeElement,setSelectedWorkId,setSelectedMaterialType]),hiddenInputErrorState===Errors_errorState.hiddenInputsNotFoundError?react.createElement(Errors_HiddenInputsNotFoundError,null):react.createElement("div",{className:"material-search"},react.createElement(material_search_MaterialSearchInputs,{searchInput,setSearchInput,availableMaterialTypes,selectedMaterialType,handleUpdateMaterialType,work,uniqueIdentifier}),react.createElement(material_search_MaterialSearchPreview,{work,isLoading:isSelectedWorkLoading,selectedMaterialType,errorState}),react.createElement(material_search_MaterialSearchList,{data:searchListData,isLoading:isSearchResultsLoading,onWorkIdSelect:id=>handleUpdateWorkId(id),selectedWorkId,loadMore,hitCount}))},material_search_MaterialSearch=MaterialSearch;try{MaterialSearch.displayName="MaterialSearch",MaterialSearch.__docgenInfo={description:"",displayName:"MaterialSearch",props:{uniqueIdentifier:{defaultValue:null,description:"",name:"uniqueIdentifier",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/material-search/MaterialSearch.tsx#MaterialSearch"]={docgenInfo:MaterialSearch.__docgenInfo,name:"MaterialSearch",path:"src/apps/material-search/MaterialSearch.tsx#MaterialSearch"})}catch(__react_docgen_typescript_loader_error){}const MaterialSearch_entry=(0,config.NV)((0,utils_url.nU)((0,utils_text.i)((({uniqueIdentifier})=>react.createElement(material_search_MaterialSearch,{uniqueIdentifier})))));try{MaterialSearchentry.displayName="MaterialSearchentry",MaterialSearchentry.__docgenInfo={description:"",displayName:"MaterialSearchentry",props:{uniqueIdentifier:{defaultValue:null,description:"",name:"uniqueIdentifier",required:!0,type:{name:"string"}},materialSearchSearchInputText:{defaultValue:null,description:"",name:"materialSearchSearchInputText",required:!0,type:{name:"string"}},materialSearchMaterialTypeSelectorText:{defaultValue:null,description:"",name:"materialSearchMaterialTypeSelectorText",required:!0,type:{name:"string"}},materialSearchMaterialTypeSelectorNoneOptionText:{defaultValue:null,description:"",name:"materialSearchMaterialTypeSelectorNoneOptionText",required:!0,type:{name:"string"}},materialSearchNoMaterialSelectedText:{defaultValue:null,description:"",name:"materialSearchNoMaterialSelectedText",required:!0,type:{name:"string"}},materialSearchPreviewTitle:{defaultValue:null,description:"",name:"materialSearchPreviewTitle",required:!0,type:{name:"string"}},materialSearchPreviewAuthor:{defaultValue:null,description:"",name:"materialSearchPreviewAuthor",required:!0,type:{name:"string"}},materialSearchPreviewPublicationYear:{defaultValue:null,description:"",name:"materialSearchPreviewPublicationYear",required:!0,type:{name:"string"}},materialSearchPreviewSource:{defaultValue:null,description:"",name:"materialSearchPreviewSource",required:!0,type:{name:"string"}},materialSearchPreviewWorkId:{defaultValue:null,description:"",name:"materialSearchPreviewWorkId",required:!0,type:{name:"string"}},materialSearchLoadingText:{defaultValue:null,description:"",name:"materialSearchLoadingText",required:!0,type:{name:"string"}},materialSearchAmountOfResultsText:{defaultValue:null,description:"",name:"materialSearchAmountOfResultsText",required:!0,type:{name:"string"}},materialSearchSearchInputPlaceholderText:{defaultValue:null,description:"",name:"materialSearchSearchInputPlaceholderText",required:!0,type:{name:"string"}},materialSearchPreviewTitleText:{defaultValue:null,description:"",name:"materialSearchPreviewTitleText",required:!0,type:{name:"string"}},materialSearchPreviewAuthorText:{defaultValue:null,description:"",name:"materialSearchPreviewAuthorText",required:!0,type:{name:"string"}},materialSearchPreviewPublicationYearText:{defaultValue:null,description:"",name:"materialSearchPreviewPublicationYearText",required:!0,type:{name:"string"}},materialSearchPreviewSourceText:{defaultValue:null,description:"",name:"materialSearchPreviewSourceText",required:!0,type:{name:"string"}},materialSearchPreviewWorkIdText:{defaultValue:null,description:"",name:"materialSearchPreviewWorkIdText",required:!0,type:{name:"string"}},materialSearchErrorTitleText:{defaultValue:null,description:"",name:"materialSearchErrorTitleText",required:!0,type:{name:"string"}},materialSearchErrorAuthorText:{defaultValue:null,description:"",name:"materialSearchErrorAuthorText",required:!0,type:{name:"string"}},materialSearchErrorLinkText:{defaultValue:null,description:"",name:"materialSearchErrorLinkText",required:!0,type:{name:"string"}},materialSearchErrorHeaderText:{defaultValue:null,description:"",name:"materialSearchErrorHeaderText",required:!0,type:{name:"string"}},materialSearchErrorMaterialTypeNotFoundText:{defaultValue:null,description:"",name:"materialSearchErrorMaterialTypeNotFoundText",required:!0,type:{name:"string"}},materialSearchErrorWorkNotFoundText:{defaultValue:null,description:"",name:"materialSearchErrorWorkNotFoundText",required:!0,type:{name:"string"}},materialSearchErrorHiddenInputsNotFoundHeadingText:{defaultValue:null,description:"",name:"materialSearchErrorHiddenInputsNotFoundHeadingText",required:!0,type:{name:"string"}},materialSearchErrorHiddenInputsNotFoundDescriptionText:{defaultValue:null,description:"",name:"materialSearchErrorHiddenInputsNotFoundDescriptionText",required:!0,type:{name:"string"}},materialSearchAriaButtonSelectWorkWithText:{defaultValue:null,description:"",name:"materialSearchAriaButtonSelectWorkWithText",required:!0,type:{name:"string"}},materialSearchNoResultsText:{defaultValue:null,description:"",name:"materialSearchNoResultsText",required:!0,type:{name:"string"}},alertErrorCloseText:{defaultValue:null,description:"",name:"alertErrorCloseText",required:!0,type:{name:"string"}},alertErrorMessageText:{defaultValue:null,description:"",name:"alertErrorMessageText",required:!0,type:{name:"string"}},multiselectAllOptionText:{defaultValue:null,description:"",name:"multiselectAllOptionText",required:!0,type:{name:"string"}},groupModalGoToMaterialAriaLabelText:{defaultValue:null,description:"",name:"groupModalGoToMaterialAriaLabelText",required:!0,type:{name:"string"}},availabilityAvailableText:{defaultValue:null,description:"",name:"availabilityAvailableText",required:!0,type:{name:"string"}},availabilityUnavailableText:{defaultValue:null,description:"",name:"availabilityUnavailableText",required:!0,type:{name:"string"}},loansNotOverdueText:{defaultValue:null,description:"",name:"loansNotOverdueText",required:!0,type:{name:"string"}},patronContactInfoBodyText:{defaultValue:null,description:"",name:"patronContactInfoBodyText",required:!0,type:{name:"string"}},pauseReservationModalBelowInputsText:{defaultValue:null,description:"",name:"pauseReservationModalBelowInputsText",required:!0,type:{name:"string"}},materialDetailsCloseModalAriaLabelText:{defaultValue:null,description:"",name:"materialDetailsCloseModalAriaLabelText",required:!0,type:{name:"string"}},findOnShelfExpandButtonExplanationText:{defaultValue:null,description:"",name:"findOnShelfExpandButtonExplanationText",required:!0,type:{name:"string"}},reservationsStillInQueueForText:{defaultValue:null,description:"",name:"reservationsStillInQueueForText",required:!0,type:{name:"string"}},materialDetailsModalAriaDescriptionText:{defaultValue:null,description:"",name:"materialDetailsModalAriaDescriptionText",required:!0,type:{name:"string"}},changePickupLocationText:{defaultValue:null,description:"",name:"changePickupLocationText",required:!0,type:{name:"string"}},changeInterestPeriodText:{defaultValue:null,description:"",name:"changeInterestPeriodText",required:!0,type:{name:"string"}},modalReservationFormPickupLabelText:{defaultValue:null,description:"",name:"modalReservationFormPickupLabelText",required:!0,type:{name:"string"}},screenReaderModalDescriptionPickupText:{defaultValue:null,description:"",name:"screenReaderModalDescriptionPickupText",required:!0,type:{name:"string"}},closeModalAriaLabelPickupText:{defaultValue:null,description:"",name:"closeModalAriaLabelPickupText",required:!0,type:{name:"string"}},modalReservationFormNoInterestAfterHeaderTitleText:{defaultValue:null,description:"",name:"modalReservationFormNoInterestAfterHeaderTitleText",required:!0,type:{name:"string"}},modalReservationFormNoInterestAfterHeaderDescriptionText:{defaultValue:null,description:"",name:"modalReservationFormNoInterestAfterHeaderDescriptionText",required:!0,type:{name:"string"}},modalReservationFormNoInterestAfterLabelText:{defaultValue:null,description:"",name:"modalReservationFormNoInterestAfterLabelText",required:!0,type:{name:"string"}},screenReaderModalDescriptionEmailText:{defaultValue:null,description:"",name:"screenReaderModalDescriptionEmailText",required:!0,type:{name:"string"}},screenReaderModalDescriptionInterestPeriodText:{defaultValue:null,description:"",name:"screenReaderModalDescriptionInterestPeriodText",required:!0,type:{name:"string"}},screenReaderModalDescriptionSmsText:{defaultValue:null,description:"",name:"screenReaderModalDescriptionSmsText",required:!0,type:{name:"string"}},closeModalAriaLabelEmailText:{defaultValue:null,description:"",name:"closeModalAriaLabelEmailText",required:!0,type:{name:"string"}},closeModalAriaLabelInterestPeriodText:{defaultValue:null,description:"",name:"closeModalAriaLabelInterestPeriodText",required:!0,type:{name:"string"}},closeModalAriaLabelSmsText:{defaultValue:null,description:"",name:"closeModalAriaLabelSmsText",required:!0,type:{name:"string"}},deleteReservationModalButtonText:{defaultValue:null,description:"",name:"deleteReservationModalButtonText",required:!0,type:{name:"string"}},pauseReservationModalAriaDescriptionText:{defaultValue:null,description:"",name:"pauseReservationModalAriaDescriptionText",required:!0,type:{name:"string"}},acceptModalAriaDescriptionText:{defaultValue:null,description:"",name:"acceptModalAriaDescriptionText",required:!0,type:{name:"string"}},addToFavoritesAriaLabelText:{defaultValue:null,description:"",name:"addToFavoritesAriaLabelText",required:!0,type:{name:"string"}},removeFromFavoritesAriaLabelText:{defaultValue:null,description:"",name:"removeFromFavoritesAriaLabelText",required:!0,type:{name:"string"}},acceptModalAriaLabelText:{defaultValue:null,description:"",name:"acceptModalAriaLabelText",required:!0,type:{name:"string"}},acceptModalHeaderText:{defaultValue:null,description:"",name:"acceptModalHeaderText",required:!0,type:{name:"string"}},acceptModalAreYouSureText:{defaultValue:null,description:"",name:"acceptModalAreYouSureText",required:!0,type:{name:"string"}},acceptModalBodyText:{defaultValue:null,description:"",name:"acceptModalBodyText",required:!0,type:{name:"string"}},acceptModalCancelButtonText:{defaultValue:null,description:"",name:"acceptModalCancelButtonText",required:!0,type:{name:"string"}},acceptModalAcceptButtonText:{defaultValue:null,description:"",name:"acceptModalAcceptButtonText",required:!0,type:{name:"string"}},isLoadingHeartText:{defaultValue:null,description:"",name:"isLoadingHeartText",required:!0,type:{name:"string"}},reservationPickUpLatestText:{defaultValue:null,description:"",name:"reservationPickUpLatestText",required:!0,type:{name:"string"}},reservationListReadyText:{defaultValue:null,description:"",name:"reservationListReadyText",required:!0,type:{name:"string"}},reservationListDigitalPickupText:{defaultValue:null,description:"",name:"reservationListDigitalPickupText",required:!0,type:{name:"string"}},pincodeSectionDescriptionText:{defaultValue:null,description:"",name:"pincodeSectionDescriptionText",required:!0,type:{name:"string"}},errorBoundaryAlertBodyButtonAriaText:{defaultValue:null,description:"",name:"errorBoundaryAlertBodyButtonAriaText",required:!0,type:{name:"string"}},buttonText:{defaultValue:null,description:"",name:"buttonText",required:!0,type:{name:"string"}},etAlText:{defaultValue:null,description:"",name:"etAlText",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/apps/material-search/MaterialSearch.entry.tsx#MaterialSearchentry"]={docgenInfo:MaterialSearchentry.__docgenInfo,name:"MaterialSearchentry",path:"src/apps/material-search/MaterialSearch.entry.tsx#MaterialSearchentry"})}catch(__react_docgen_typescript_loader_error){}function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(null,arguments)}const uniqueIdentifierValue=Math.floor(1e4*Math.random()),MaterialSearchHiddenInputs=({defaultWorkId,defaultMaterialType,uniqueIdentifier,...args})=>react.createElement("div",{className:"material-search"},react.createElement("span",null,"Input fields only shown in storybook. They are used to reflect how the hidden workId and materialType fields are updated."),react.createElement("div",{className:"material-search__inputs-container"},react.createElement("label",{className:"material-search__label",htmlFor:"material-search-input"},"Work id",react.createElement("input",{"data-field-input-work-id":uniqueIdentifier,type:"text",placeholder:"Enter search terms",className:"material-search__input",tabIndex:-1,defaultValue:defaultWorkId})),react.createElement("label",{className:"material-search__label",htmlFor:"material-type-selector"},"Material type",react.createElement("input",{"data-field-input-material-type-id":uniqueIdentifier,type:"text",className:"material-search__selector",tabIndex:-1,defaultValue:defaultMaterialType}))),react.createElement(MaterialSearch_entry,_extends({uniqueIdentifier},args))),MaterialSearch_stories={title:"Apps / Material Search",component:MaterialSearchHiddenInputs,argTypes:{...globalTextArgs.U,...serviceUrlArgs.U,...globalConfigArgs.U,uniqueIdentifier:{control:{type:"number"}},previouslySelectedWorkId:{control:{type:"text"}},previouslySelectedMaterialType:{control:{type:"text"}},etAlText:{control:{type:"text"}},materialUrl:{control:{type:"text"}},materialSearchSearchInputText:{control:{type:"text"}},materialSearchMaterialTypeSelectorText:{control:{type:"text"}},materialSearchMaterialTypeSelectorNoneOptionText:{control:{type:"text"}},materialSearchNoMaterialSelectedText:{control:{type:"text"}},materialSearchPreviewTitle:{control:{type:"text"}},materialSearchPreviewAuthor:{control:{type:"text"}},materialSearchPreviewPublicationYear:{control:{type:"text"}},materialSearchPreviewSource:{control:{type:"text"}},materialSearchPreviewWorkId:{control:{type:"text"}},materialSearchLoadingText:{control:{type:"text"}},materialSearchAmountOfResultsText:{control:{type:"text"}},materialSearchNoResultsText:{control:{type:"text"}},materialSearchAriaButtonSelectWorkWithText:{control:{type:"text"}},materialSearchSearchInputPlaceholderText:{control:{type:"text"}},materialSearchPreviewTitleText:{control:{type:"text"}},materialSearchPreviewAuthorText:{control:{type:"text"}},materialSearchPreviewPublicationYearText:{control:{type:"text"}},materialSearchPreviewSourceText:{control:{type:"text"}},materialSearchPreviewWorkIdText:{control:{type:"text"}},materialSearchErrorTitleText:{control:{type:"text"}},materialSearchErrorAuthorText:{control:{type:"text"}},materialSearchErrorLinkText:{control:{type:"text"}},materialSearchErrorHeaderText:{control:{type:"text"}},materialSearchErrorMaterialTypeNotFoundText:{control:{type:"text"}},materialSearchErrorWorkNotFoundText:{control:{type:"text"}},materialSearchErrorHiddenInputsNotFoundHeadingText:{control:{type:"text"}},materialSearchErrorHiddenInputsNotFoundDescriptionText:{control:{type:"text"}}}},Primary={args:{...globalTextArgs.A,...serviceUrlArgs.A,...globalConfigArgs.A,uniqueIdentifier:uniqueIdentifierValue.toString(),previouslySelectedWorkId:"work-of:800010-katalog:99122475830405763",previouslySelectedMaterialType:"lydbog (cd-mp3)",etAlText:"et al.",materialUrl:"/work/:workid",materialSearchSearchInputText:"Search for material",materialSearchMaterialTypeSelectorText:"Select material type",materialSearchMaterialTypeSelectorNoneOptionText:"Select material type",materialSearchNoMaterialSelectedText:"No material selected",materialSearchPreviewTitle:"Title",materialSearchPreviewAuthor:"Author",materialSearchPreviewPublicationYear:"Publication year",materialSearchPreviewSource:"Source",materialSearchPreviewWorkId:"Work ID",materialSearchLoadingText:"Loading...",materialSearchAmountOfResultsText:"Amount of hits",materialSearchNoResultsText:"No results",materialSearchAriaButtonSelectWorkWithText:"Select work with title @title",materialSearchSearchInputPlaceholderText:"Enter search terms",materialSearchPreviewTitleText:"Title",materialSearchPreviewAuthorText:"Author",materialSearchPreviewPublicationYearText:"Publication year",materialSearchPreviewSourceText:"Source",materialSearchPreviewWorkIdText:"Work ID",materialSearchErrorTitleText:"Title",materialSearchErrorAuthorText:"Author",materialSearchErrorLinkText:"Link",materialSearchErrorHeaderText:"This material needs to be updated.",materialSearchErrorMaterialTypeNotFoundText:"The currently selected type of the material is no longer available in the system. As a result of this, the link is likely broken. Use the title or link underneath to find and update the material and its type, or replace / delete it.",materialSearchErrorWorkNotFoundText:"The material that was previously selected is no longer available in the system. Either delete this entry or search for a new material to replace it.",materialSearchErrorHiddenInputsNotFoundHeadingText:"Error retrieving saved data. Inputs not found.",materialSearchErrorHiddenInputsNotFoundDescriptionText:"Something went wrong when trying to find the previously saved values. Please try again. If the problem persists, something could be wrong with the app."}},WithPreviouslySelectedValues={args:{...Primary.args},render:args=>{const modifiedProps={...args,defaultWorkId:"work-of:800010-katalog:99122475830405763",defaultMaterialType:"lydbog (cd-mp3)"};return react.createElement(MaterialSearchHiddenInputs,modifiedProps)}},materialWithInvalidType={args:{...Primary.args},render:args=>{const modifiedProps={...args,defaultWorkId:"work-of:800010-katalog:99122475830405763",defaultMaterialType:"invalid-type"};return react.createElement(MaterialSearchHiddenInputs,modifiedProps)}},materialWithInvalidWorkId={args:{...Primary.args},render:args=>{const modifiedProps={...args,defaultWorkId:"invalid-work-id",defaultMaterialType:"lydbog (cd-mp3)"};return react.createElement(MaterialSearchHiddenInputs,modifiedProps)}};Primary.parameters={...Primary.parameters,docs:{...Primary.parameters?.docs,source:{originalSource:'{\n  args: {\n    ...globalTextArgs,\n    ...serviceUrlArgs,\n    ...globalConfigArgs,\n    uniqueIdentifier: uniqueIdentifierValue.toString(),\n    previouslySelectedWorkId,\n    previouslySelectedMaterialType,\n    etAlText: "et al.",\n    materialUrl: "/work/:workid",\n    materialSearchSearchInputText: "Search for material",\n    materialSearchMaterialTypeSelectorText: "Select material type",\n    materialSearchMaterialTypeSelectorNoneOptionText: "Select material type",\n    materialSearchNoMaterialSelectedText: "No material selected",\n    materialSearchPreviewTitle: "Title",\n    materialSearchPreviewAuthor: "Author",\n    materialSearchPreviewPublicationYear: "Publication year",\n    materialSearchPreviewSource: "Source",\n    materialSearchPreviewWorkId: "Work ID",\n    materialSearchLoadingText: "Loading...",\n    materialSearchAmountOfResultsText: "Amount of hits",\n    materialSearchNoResultsText: "No results",\n    materialSearchAriaButtonSelectWorkWithText: "Select work with title @title",\n    materialSearchSearchInputPlaceholderText: "Enter search terms",\n    materialSearchPreviewTitleText: "Title",\n    materialSearchPreviewAuthorText: "Author",\n    materialSearchPreviewPublicationYearText: "Publication year",\n    materialSearchPreviewSourceText: "Source",\n    materialSearchPreviewWorkIdText: "Work ID",\n    materialSearchErrorTitleText: "Title",\n    materialSearchErrorAuthorText: "Author",\n    materialSearchErrorLinkText: "Link",\n    materialSearchErrorHeaderText: "This material needs to be updated.",\n    materialSearchErrorMaterialTypeNotFoundText: "The currently selected type of the material is no longer available in the system. As a result of this, the link is likely broken. Use the title or link underneath to find and update the material and its type, or replace / delete it.",\n    materialSearchErrorWorkNotFoundText: "The material that was previously selected is no longer available in the system. Either delete this entry or search for a new material to replace it.",\n    materialSearchErrorHiddenInputsNotFoundHeadingText: "Error retrieving saved data. Inputs not found.",\n    materialSearchErrorHiddenInputsNotFoundDescriptionText: "Something went wrong when trying to find the previously saved values. Please try again. If the problem persists, something could be wrong with the app."\n  }\n}',...Primary.parameters?.docs?.source}}},WithPreviouslySelectedValues.parameters={...WithPreviouslySelectedValues.parameters,docs:{...WithPreviouslySelectedValues.parameters?.docs,source:{originalSource:"{\n  args: {\n    ...Primary.args\n  },\n  render: args => {\n    const defaultWorkId = previouslySelectedWorkId;\n    const defaultMaterialType = previouslySelectedMaterialType;\n    const modifiedProps = {\n      ...args,\n      defaultWorkId,\n      defaultMaterialType\n    };\n\n    // eslint-disable-next-line react/jsx-props-no-spreading\n    return <MaterialSearchHiddenInputs {...modifiedProps} />;\n  }\n}",...WithPreviouslySelectedValues.parameters?.docs?.source}}},materialWithInvalidType.parameters={...materialWithInvalidType.parameters,docs:{...materialWithInvalidType.parameters?.docs,source:{originalSource:'{\n  args: {\n    ...Primary.args\n  },\n  render: args => {\n    const defaultWorkId = previouslySelectedWorkId;\n    const defaultMaterialType = "invalid-type";\n    const modifiedProps = {\n      ...args,\n      defaultWorkId,\n      defaultMaterialType\n    };\n\n    // eslint-disable-next-line react/jsx-props-no-spreading\n    return <MaterialSearchHiddenInputs {...modifiedProps} />;\n  }\n}',...materialWithInvalidType.parameters?.docs?.source}}},materialWithInvalidWorkId.parameters={...materialWithInvalidWorkId.parameters,docs:{...materialWithInvalidWorkId.parameters?.docs,source:{originalSource:'{\n  args: {\n    ...Primary.args\n  },\n  render: args => {\n    const defaultWorkId = "invalid-work-id";\n    const defaultMaterialType = previouslySelectedMaterialType;\n    const modifiedProps = {\n      ...args,\n      defaultWorkId,\n      defaultMaterialType\n    };\n\n    // eslint-disable-next-line react/jsx-props-no-spreading\n    return <MaterialSearchHiddenInputs {...modifiedProps} />;\n  }\n}',...materialWithInvalidWorkId.parameters?.docs?.source}}}},"./src/components/cover/cover.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Y:()=>Cover});var react=__webpack_require__("./node_modules/react/index.js"),clsx=__webpack_require__("./node_modules/clsx/dist/clsx.mjs"),es=__webpack_require__("./node_modules/react-query/es/index.js"),FetchFailedError=__webpack_require__("./src/core/fetchers/FetchFailedError.ts"),token=__webpack_require__("./src/core/token.js"),extractServiceBaseUrls=__webpack_require__("./src/core/utils/reduxMiddleware/extractServiceBaseUrls.ts"),FetcherHttpError=__webpack_require__("./src/core/fetchers/FetcherHttpError.ts");function _defineProperty(e,r,t){return(r=function _toPropertyKey(t){var i=function _toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class CoverServiceHttpError extends FetcherHttpError.A{constructor(...args){super(...args),_defineProperty(this,"name","CoverServiceHttpError")}}const fetcher=async({url,method,params,data})=>{const additionalHeaders="object"===(null==data?void 0:data.headers)?null==data?void 0:data.headers:{},libraryToken=(0,token.gf)(token._L),headers={...libraryToken?{Authorization:`Bearer ${libraryToken}`}:{},...additionalHeaders},body=data?JSON.stringify(data):null,serviceUrl=(({baseUrl,url,params})=>`${baseUrl}${url}?${new URLSearchParams(params)}`)({baseUrl:(0,extractServiceBaseUrls.aW)(extractServiceBaseUrls.TJ.cover),url,params});try{const response=await fetch(serviceUrl,{method,headers,body});if(!response.ok)throw new CoverServiceHttpError(response.status,response.statusText,serviceUrl);try{return await response.json()}catch(e){if(!(e instanceof SyntaxError))throw e}}catch(error){if(error instanceof CoverServiceHttpError)throw error;const message=error instanceof Error?error.message:"Unknown error";throw new FetchFailedError.A(message,serviceUrl)}return null},getGetCoverCollectionQueryOptions=(params,options)=>{const{query:queryOptions}=options??{},queryKey=(null==queryOptions?void 0:queryOptions.queryKey)??(params=>["/api/v2/covers",...params?[params]:[]])(params);return{queryKey,queryFn:({signal})=>((params,signal)=>fetcher({url:"/api/v2/covers",method:"GET",params,signal}))(params,signal),...queryOptions}};var LinkNoStyle=__webpack_require__("./src/components/atoms/links/LinkNoStyle.tsx");const cover_image=({src,altText,animate,setImageLoaded,shadow})=>react.createElement("img",{onLoad:setImageLoaded,className:(0,clsx.A)("cover__img",{"cover__img--animate":animate},{"cover__img--shadow-small":"small"===shadow,"cover__img--shadow-medium":"medium"===shadow}),src,alt:altText||""});try{coverimage.displayName="coverimage",coverimage.__docgenInfo={description:"",displayName:"coverimage",props:{src:{defaultValue:null,description:"",name:"src",required:!0,type:{name:"string"}},altText:{defaultValue:null,description:"",name:"altText",required:!1,type:{name:"string | undefined"}},animate:{defaultValue:null,description:"",name:"animate",required:!0,type:{name:"boolean"}},setImageLoaded:{defaultValue:null,description:"",name:"setImageLoaded",required:!0,type:{name:"() => void"}},shadow:{defaultValue:null,description:"",name:"shadow",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"small"'},{value:'"medium"'}]}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/cover/cover-image.tsx#coverimage"]={docgenInfo:coverimage.__docgenInfo,name:"coverimage",path:"src/components/cover/cover-image.tsx#coverimage"})}catch(__react_docgen_typescript_loader_error){}var first=__webpack_require__("./node_modules/lodash/first.js"),first_default=__webpack_require__.n(first);const getUrl=(cover,size)=>{var _cover$imageUrls,_cover$imageUrls$size;return null===(_cover$imageUrls=cover.imageUrls)||void 0===_cover$imageUrls||null===(_cover$imageUrls$size=_cover$imageUrls[size])||void 0===_cover$imageUrls$size?void 0:_cover$imageUrls$size.url},getCoverUrl=({coverData,bestRepresentation,size})=>{if(!coverData)return null;const covers=(({coverData,size})=>coverData?coverData.filter((cover=>getUrl(cover,size))):[])({coverData,size}),firstCover=first_default()(covers);if(!bestRepresentation&&firstCover&&getUrl(firstCover,size))return getUrl(firstCover,size);const bestRepresentationCover=first_default()(covers.filter((cover=>bestRepresentation&&cover.id===bestRepresentation.pid)));return bestRepresentationCover&&getUrl(bestRepresentationCover,size)?getUrl(bestRepresentationCover,size):firstCover&&getUrl(firstCover,size)?getUrl(firstCover,size):null};const Cover=({url,alt,size,displaySize,animate,tint,ids,bestRepresentation,idType="pid",shadow,linkAriaLabelledBy})=>{const[imageLoaded,setImageLoaded]=(0,react.useState)(null),handleSetImageLoaded=(0,react.useCallback)((()=>{setImageLoaded(!0)}),[]);let dataSize=size;"xsmall"===dataSize?dataSize="small":"xlarge"===dataSize&&(dataSize="large");const{data}=function useGetCoverCollection(params,options){const queryOptions=getGetCoverCollectionQueryOptions(params,options),query=(0,es.useQuery)(queryOptions);return query.queryKey=queryOptions.queryKey,query}({type:idType,identifiers:ids,sizes:[dataSize]}),coverSrc=getCoverUrl({coverData:data,bestRepresentation,size:dataSize}),coverDisplaySize=displaySize||size,classes={wrapper:(0,clsx.A)("cover",`cover--size-${coverDisplaySize}`,`cover--aspect-${coverDisplaySize}`,imageLoaded||{default:"bg-identity-tint-120",120:"bg-identity-tint-120",100:"bg-identity-tint-100",80:"bg-identity-tint-80",40:"bg-identity-tint-40",20:"bg-identity-tint-20"}[tint||"default"])};return url?react.createElement(LinkNoStyle.A,{className:classes.wrapper,url,ariaLabelledBy:linkAriaLabelledBy,isHiddenFromScreenReaders:!alt},coverSrc&&react.createElement(cover_image,{setImageLoaded:handleSetImageLoaded,src:coverSrc,altText:alt,animate,shadow})):react.createElement("div",{className:classes.wrapper},coverSrc&&react.createElement(cover_image,{setImageLoaded:handleSetImageLoaded,src:coverSrc,altText:alt,animate,shadow}))};try{Cover.displayName="Cover",Cover.__docgenInfo={description:"",displayName:"Cover",props:{animate:{defaultValue:null,description:"",name:"animate",required:!0,type:{name:"boolean"}},size:{defaultValue:null,description:"",name:"size",required:!0,type:{name:"enum",value:[{value:'"xsmall"'},{value:'"small"'},{value:'"medium"'},{value:'"large"'},{value:'"xlarge"'},{value:'"original"'}]}},displaySize:{defaultValue:null,description:"",name:"displaySize",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"xsmall"'},{value:'"small"'},{value:'"medium"'},{value:'"large"'},{value:'"xlarge"'},{value:'"original"'},{value:'"2xsmall"'}]}},tint:{defaultValue:null,description:"",name:"tint",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"20"'},{value:'"40"'},{value:'"80"'},{value:'"100"'},{value:'"120"'}]}},ids:{defaultValue:null,description:"",name:"ids",required:!0,type:{name:"string[]"}},bestRepresentation:{defaultValue:null,description:"",name:"bestRepresentation",required:!1,type:{name:"Manifestation | undefined"}},alt:{defaultValue:null,description:"",name:"alt",required:!1,type:{name:"string | undefined"}},url:{defaultValue:null,description:"",name:"url",required:!1,type:{name:"URL | undefined"}},idType:{defaultValue:{value:"pid"},description:"",name:"idType",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"pid"'},{value:'"faust"'},{value:'"isbn"'},{value:'"issn"'}]}},shadow:{defaultValue:null,description:"",name:"shadow",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"small"'},{value:'"medium"'}]}},linkAriaLabelledBy:{defaultValue:null,description:"",name:"linkAriaLabelledBy",required:!1,type:{name:"string | undefined"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/cover/cover.tsx#Cover"]={docgenInfo:Cover.__docgenInfo,name:"Cover",path:"src/components/cover/cover.tsx#Cover"})}catch(__react_docgen_typescript_loader_error){}},"./src/core/storybook/globalConfigArgs.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__,U:()=>argTypes});const argTypes={errorMessagesConfig:{description:"Configuration for error messages behaviour",control:{type:"text"},table:{type:{summary:"text"},defaultValue:{summary:'{"containerId":"dpl-react-apps-error-messages","shouldOnlyShowOneError":true,"showCloseButton":true}'}}}},__WEBPACK_DEFAULT_EXPORT__={errorMessagesConfig:'{"containerId":"dpl-react-apps-error-messages","shouldOnlyShowOneError":true,"showCloseButton":true}'}},"./node_modules/lodash/_arrayAggregator.js":module=>{module.exports=function arrayAggregator(array,setter,iteratee,accumulator){for(var index=-1,length=null==array?0:array.length;++index<length;){var value=array[index];setter(accumulator,value,iteratee(value),array)}return accumulator}},"./node_modules/lodash/_baseAggregator.js":(module,__unused_webpack_exports,__webpack_require__)=>{var baseEach=__webpack_require__("./node_modules/lodash/_baseEach.js");module.exports=function baseAggregator(collection,setter,iteratee,accumulator){return baseEach(collection,(function(value,key,collection){setter(accumulator,value,iteratee(value),collection)})),accumulator}},"./node_modules/lodash/_baseAssignValue.js":(module,__unused_webpack_exports,__webpack_require__)=>{var defineProperty=__webpack_require__("./node_modules/lodash/_defineProperty.js");module.exports=function baseAssignValue(object,key,value){"__proto__"==key&&defineProperty?defineProperty(object,key,{configurable:!0,enumerable:!0,value,writable:!0}):object[key]=value}},"./node_modules/lodash/_createAggregator.js":(module,__unused_webpack_exports,__webpack_require__)=>{var arrayAggregator=__webpack_require__("./node_modules/lodash/_arrayAggregator.js"),baseAggregator=__webpack_require__("./node_modules/lodash/_baseAggregator.js"),baseIteratee=__webpack_require__("./node_modules/lodash/_baseIteratee.js"),isArray=__webpack_require__("./node_modules/lodash/isArray.js");module.exports=function createAggregator(setter,initializer){return function(collection,iteratee){var func=isArray(collection)?arrayAggregator:baseAggregator,accumulator=initializer?initializer():{};return func(collection,setter,baseIteratee(iteratee,2),accumulator)}}},"./node_modules/lodash/_defineProperty.js":(module,__unused_webpack_exports,__webpack_require__)=>{var getNative=__webpack_require__("./node_modules/lodash/_getNative.js"),defineProperty=function(){try{var func=getNative(Object,"defineProperty");return func({},"",{}),func}catch(e){}}();module.exports=defineProperty},"./node_modules/lodash/compact.js":module=>{module.exports=function compact(array){for(var index=-1,length=null==array?0:array.length,resIndex=0,result=[];++index<length;){var value=array[index];value&&(result[resIndex++]=value)}return result}},"./node_modules/lodash/groupBy.js":(module,__unused_webpack_exports,__webpack_require__)=>{var baseAssignValue=__webpack_require__("./node_modules/lodash/_baseAssignValue.js"),createAggregator=__webpack_require__("./node_modules/lodash/_createAggregator.js"),hasOwnProperty=Object.prototype.hasOwnProperty,groupBy=createAggregator((function(result,value,key){hasOwnProperty.call(result,key)?result[key].push(value):baseAssignValue(result,key,[value])}));module.exports=groupBy},"./node_modules/lodash/uniqBy.js":(module,__unused_webpack_exports,__webpack_require__)=>{var baseIteratee=__webpack_require__("./node_modules/lodash/_baseIteratee.js"),baseUniq=__webpack_require__("./node_modules/lodash/_baseUniq.js");module.exports=function uniqBy(array,iteratee){return array&&array.length?baseUniq(array,baseIteratee(iteratee,2)):[]}},"./node_modules/react-use/esm/misc/util.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{AU:()=>off,Bd:()=>isBrowser,lQ:()=>noop,on:()=>on});var noop=function(){};function on(obj){for(var args=[],_i=1;_i<arguments.length;_i++)args[_i-1]=arguments[_i];obj&&obj.addEventListener&&obj.addEventListener.apply(obj,args)}function off(obj){for(var args=[],_i=1;_i<arguments.length;_i++)args[_i-1]=arguments[_i];obj&&obj.removeEventListener&&obj.removeEventListener.apply(obj,args)}var isBrowser="undefined"!=typeof window},"./node_modules/react-use/esm/useIntersection.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js");const __WEBPACK_DEFAULT_EXPORT__=function(ref,options){var _a=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(null),intersectionObserverEntry=_a[0],setIntersectionObserverEntry=_a[1];return(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((function(){if(ref.current&&"function"==typeof IntersectionObserver){var observer_1=new IntersectionObserver((function(entries){setIntersectionObserverEntry(entries[0])}),options);return observer_1.observe(ref.current),function(){setIntersectionObserverEntry(null),observer_1.disconnect()}}return function(){}}),[ref.current,options.threshold,options.root,options.rootMargin]),intersectionObserverEntry}},"./node_modules/@danskernesdigitalebibliotek/dpl-design-system/build/icons/basic/icon-warning.svg":module=>{module.exports="data:image/svg+xml,%3csvg width='40' height='40' viewBox='0 0 40 40' fill='none' xmlns='http://www.w3.org/2000/svg'%3e %3cellipse cx='20' cy='19.9822' rx='20' ry='19.9822' fill='%23D22D43'/%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M20.0463 24.75C20.4263 24.75 20.7404 24.4678 20.7901 24.1018L20.7969 24V11C20.7969 10.5858 20.4608 10.25 20.0463 10.25C19.6662 10.25 19.3521 10.5322 19.3024 10.8982L19.2956 11V24C19.2956 24.4142 19.6317 24.75 20.0463 24.75ZM20.0463 29.75C20.8754 29.75 21.5476 29.0784 21.5476 28.25C21.5476 27.4216 20.8754 26.75 20.0463 26.75C19.2171 26.75 18.5449 27.4216 18.5449 28.25C18.5449 29.0784 19.2171 29.75 20.0463 29.75Z' fill='%23F6F5F0'/%3e %3c/svg%3e"},"./node_modules/@danskernesdigitalebibliotek/dpl-design-system/build/icons/logo/reload_logo_black.svg":module=>{module.exports="data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400' viewBox='0 0 400 400'%3e%3ctitle%3eReload_mark_RGB_black%3c/title%3e%3cpath d='M257.3,166.8A67.1,67.1,0,1,1,200,134.6h0l-20.7,20.7L200,176l38.5-38.5h0l20.7-20.7L200,57.6,179.3,78.3,200,99h0a102.5,102.5,0,1,0,87.7,49.3Z'/%3e%3c/svg%3e"}}]);